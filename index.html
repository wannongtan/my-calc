<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å·¥ç¨‹é‡è¨ˆç®—æ©Ÿ - è«è˜­è¿ªç‰ˆ</title>
    <style>
        :root { 
            --primary: #92a9bd;    /* ç°çŸ³è— */
            --bg: #ebe8e2;         /* è«è˜­è¿ªç±³ç™½ */
            --success: #a7bcb9;    /* ç…™ç‡»ç¶  */
            --warning: #c0a080;    /* ç°é™¶è‰² */
            --card-bg: #ffffff;
            --text: #555555;
            --border: #d1d1d1;
        }
        body { 
            font-family: -apple-system, "Segoe UI", sans-serif; 
            background: var(--bg); 
            margin: 0; 
            padding: 15px; 
            color: var(--text);
            padding-bottom: 50px;
        }
        .card { 
            background: var(--card-bg); 
            border-radius: 12px; 
            padding: 18px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.05); 
            margin-bottom: 20px; 
        }
        h1 { font-size: 1.3rem; color: #7e8a97; text-align: center; margin-bottom: 20px; }
        h2 { 
            color: var(--primary); 
            font-size: 1.05rem; 
            margin-top: 0; 
            border-left: 3px solid var(--primary); 
            padding-left: 10px; 
            margin-bottom: 15px;
        }
        .row { display: flex; gap: 8px; margin-bottom: 10px; }
        input, select { 
            flex: 1; 
            padding: 12px; 
            border: 1px solid var(--border); 
            border-radius: 8px; 
            font-size: 16px; 
            width: 100%; 
            box-sizing: border-box; 
            outline: none; 
            background: #fafafa;
            color: var(--text);
        }
        button { 
            width: 100%; 
            border: none; 
            padding: 14px; 
            border-radius: 8px; 
            font-size: 16px; 
            font-weight: 600; 
            cursor: pointer; 
            color: white; 
            transition: opacity 0.2s;
        }
        button:active { opacity: 0.8; }
        .add-btn { background: var(--primary); margin-bottom: 6px; }
        .tp-btn { background: var(--success); }
        .total { 
            background: #f8f9fa; 
            padding: 10px; 
            border-radius: 6px; 
            color: #7e8a97; 
            font-weight: bold; 
            margin-top: 12px; 
            text-align: right; 
            border: 1px inset #eee;
        }
        table { width: 100%; border-collapse: collapse; margin-top: 12px; }
        td { padding: 10px 0; border-top: 1px solid #f0f0f0; font-size: 0.85rem; color: #777; }
        .del-btn { color: var(--warning); border: none; background: none; font-size: 13px; cursor: pointer; }
        .clear-all { text-align: center; margin: 40px 0; }
        .clear-btn { background: var(--warning); opacity: 0.85; padding: 10px 30px; }
        .hint { font-size: 0.7rem; color: #999; margin-bottom: 5px; }
    </style>
</head>
<body>

    <h1>ğŸ—ï¸ å·¥ç¨‹è¨ˆç®—å°å¹«æ‰‹</h1>

    <div class="card">
        <h2>é«˜ç¨‹æ”¾æ¨£ (Stakeout)</h2>
        <div class="hint">å…¬å¼ï¼š(BM + BS) - è¨­è¨ˆé«˜ = è®€æ•¸</div>
        <div class="row">
            <input type="number" id="stBM" placeholder="åŸºæº–(BM)" step="0.001">
            <input type="number" id="stBS" placeholder="å¾Œè¦–(BS)" step="0.001">
        </div>
        <div class="row">
            <input type="number" id="stDS" placeholder="è¨­è¨ˆé«˜" step="0.001">
        </div>
        <button class="add-btn" onclick="calcItem('leveling')">è¨ˆç®—æ”¾æ¨£è®€æ•¸</button>
        <div id="list-leveling"></div>
        <div class="total" id="tot-leveling">æ‡‰è®€æ•¸ï¼š0.000 m</div>
    </div>

    <div class="card" style="border-top: 4px solid var(--success);">
        <h2>æ§åˆ¶é»è½‰é» (TP)</h2>
        <div class="hint">å…¬å¼ï¼š(BM + BS) - FS = æ–°é»é«˜ç¨‹</div>
        <div class="row">
            <input type="number" id="tpBM" placeholder="èˆŠåŸºæº–(BM)" step="0.001">
            <input type="number" id="tpBS" placeholder="å¾Œè¦–(BS)" step="0.001">
        </div>
        <div class="row">
            <input type="number" id="tpFS" placeholder="å‰è¦–(FS)" step="0.001">
        </div>
        <button class="tp-btn" onclick="calcItem('transfer')">è¨ˆç®—æ–°é»é«˜ç¨‹</button>
        <div id="list-transfer"></div>
        <div class="total" id="tot-transfer">æ–°é»é«˜ï¼š0.000 m</div>
    </div>

    <div class="card">
        <h2>æ°´æ³¥æ¾†ç½® (mÂ³)</h2>
        <div class="row">
            <input type="number" id="cL" placeholder="é•·">
            <input type="number" id="cW" placeholder="å¯¬">
            <input type="number" id="cH" placeholder="é«˜">
        </div>
        <button class="add-btn" onclick="calcItem('concrete')">æ–°å¢æ°´æ³¥ç´€éŒ„</button>
        <div id="list-concrete"></div>
        <div class="total" id="tot-concrete">ç¸½è¨ˆï¼š0.00 mÂ³</div>
    </div>

    <div class="card">
        <h2>é‹¼ç­‹é‡é‡ (kg)</h2>
        <div class="row">
            <select id="rT">
                <option value="0.560">D10 #3 (0.560)</option>
                <option value="0.994">D13 #4 (0.994)</option>
                <option value="1.550">D16 #5 (1.550)</option>
                <option value="2.250">D19 #6 (2.250)</option>
                <option value="3.040">D22 #7 (3.040)</option>
                <option value="3.980">D25 #8 (3.980)</option>
            </select>
            <input type="number" id="rL" placeholder="ç¸½é•·åº¦(m)">
            <input type="number" id="rN" placeholder="æ ¹æ•¸">
        </div>
        <button class="add-btn" onclick="calcItem('rebar')">æ–°å¢é‹¼ç­‹ç´€éŒ„</button>
        <div id="list-rebar"></div>
        <div class="total" id="tot-rebar">ç¸½è¨ˆï¼š0.00 kg</div>
    </div>

    <div class="card">
        <h2>æ¨¡æ¿é¢ç© (mÂ²)</h2>
        <div class="row">
            <input type="number" id="fL" placeholder="é•·">
            <input type="number" id="fW" placeholder="å¯¬">
            <select id="fS">
                <option value="1">å–®é¢</option>
                <option value="2">é›™é¢</option>
            </select>
        </div>
        <button class="add-btn" onclick="calcItem('form')">æ–°å¢æ¨¡æ¿ç´€éŒ„</button>
        <div id="list-form"></div>
        <div class="total" id="tot-form">ç¸½è¨ˆï¼š0.00 mÂ²</div>
    </div>

    <div class="clear-all">
        <button class="clear-btn" onclick="resetAll()">ğŸ§¨ æ¸…é™¤æ‰€æœ‰æ•¸æ“š</button>
    </div>

    <script>
        let db = { concrete: [], rebar: [], form: [], leveling: [], transfer: [] };
        const saved = localStorage.getItem('engData');
        if (saved) db = JSON.parse(saved);

        function saveAndRender() {
            localStorage.setItem('engData', JSON.stringify(db));
            render();
        }

        function calcItem(type) {
            let val = 0; let info = "";
            if (type === 'leveling') {
                let bm = parseFloat(document.getElementById('stBM').value) || 0;
                let bs = parseFloat(document.getElementById('stBS').value) || 0;
                let ds = parseFloat(document.getElementById('stDS').value) || 0;
                val = (bm + bs) - ds;
                info = `æ”¾æ¨£ | BM:${bm}+BS:${bs}-è¨­:${ds}`;
                document.getElementById('stDS').value = '';
            } else if (type === 'transfer') {
                let bm = parseFloat(document.getElementById('tpBM').value) || 0;
                let bs = parseFloat(document.getElementById('tpBS').value) || 0;
                let fs = parseFloat(document.getElementById('tpFS').value) || 0;
                val = (bm + bs) - fs;
                info = `è½‰é» | BM:${bm}+BS:${bs}-FS:${fs}`;
                if(confirm(`æ–°é»é«˜ç¨‹ç‚º ${val.toFixed(3)}ï¼Œæ˜¯å¦æ›´æ–°ç‚ºæ–°åŸºæº–é»ï¼Ÿ`)) {
                    document.getElementById('tpBM').value = val.toFixed(3);
                    document.getElementById('stBM').value = val.toFixed(3);
                    document.getElementById('tpBS').value = ''; document.getElementById('tpFS').value = '';
                }
            } else if (type === 'concrete') {
                let l = parseFloat(document.getElementById('cL').value), w = parseFloat(document.getElementById('cW').value), h = parseFloat(document.getElementById('cH').value);
                if(l && w && h) { val = l * w * h; info = `${l}Ã—${w}Ã—${h}`; }
            } else if (type === 'rebar') {
                let unit = parseFloat(document.getElementById('rT').value), l = parseFloat(document.getElementById('rL').value), n = parseFloat(document.getElementById('rN').value);
                let name = document.getElementById('rT').options[document.getElementById('rT').selectedIndex].text.split(' (')[0];
                if(l && n) { val = unit * l * n; info = `${name} | ${l}mÃ—${n}æ”¯`; }
            } else if (type === 'form') {
                let l = parseFloat(document.getElementById('fL').value), w = parseFloat(document.getElementById('fW').value), s = parseInt(document.getElementById('fS').value);
                if(l && w) { val = l * w * s; info = `${l}Ã—${w} (${s==1?'å–®':'é›™'})`; }
            }

            if (info !== "") {
                db[type].push({ v: val, t: info });
                saveAndRender();
            }
        }

        function removeAt(type, i) { db[type].splice(i, 1); saveAndRender(); }
        function resetAll() { if(confirm('ç¢ºå®šè¦æ¸…ç©ºå—ï¼Ÿ')) { db = { concrete: [], rebar: [], form: [], leveling: [], transfer: [] }; saveAndRender(); } }

        function render() {
            ['concrete', 'rebar', 'form', 'leveling', 'transfer'].forEach(type => {
                let html = '<table>'; let sum = 0;
                db[type].forEach((item, i) => {
                    sum += item.v;
                    let displayVal = (type === 'leveling' || type === 'transfer') ? item.v.toFixed(3) : item.v.toFixed(2);
                    html += `<tr><td>${item.t}</td><td align="right">${displayVal}</td>
                             <td align="right"><button class="del-btn" onclick="removeAt('${type}',${i})">åˆªé™¤</button></td></tr>`;
                });
                document.getElementById(`list-${type}`).innerHTML = html + '</table>';
                if(type === 'leveling' || type === 'transfer') {
                    let last = db[type].length > 0 ? db[type][db[type].length-1].v.toFixed(3) : "0.000";
                    document.getElementById(`tot-${type}`).innerText = (type === 'leveling' ? 'æ‡‰è®€æ•¸ï¼š' : 'æ–°é»é«˜ï¼š') + last + ' m';
                } else {
                    let unit = type==='concrete'?' mÂ³':(type==='rebar'?' kg':' mÂ²');
                    document.getElementById(`tot-${type}`).innerText = `ç¸½è¨ˆï¼š${sum.toFixed(2)}${unit}`;
                }
            });
        }
        render();
    </script>
</body>
</html>
